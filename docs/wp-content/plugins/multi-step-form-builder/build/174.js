/*! For license information please see 174.js.LICENSE.txt */
"use strict";(self.webpackChunkmulti_step_form_builder=self.webpackChunkmulti_step_form_builder||[]).push([[174],{174(e,r,t){t.d(r,{default:()=>v});var n=t(594),i=t(470),o=t(842),s=t.n(o),u=t(214),a=t(848);function l(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(){var e,r,t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",i=t.toStringTag||"@@toStringTag";function o(t,n,i,o){var a=n&&n.prototype instanceof u?n:u,l=Object.create(a.prototype);return d(l,"_invoke",function(t,n,i){var o,u,a,l=0,c=i||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(r,t){return o=r,u=0,a=e,f.n=t,s}};function m(t,n){for(u=t,a=n,r=0;!d&&l&&!i&&r<c.length;r++){var i,o=c[r],m=f.p,p=o[2];t>3?(i=p===n)&&(a=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=m&&((i=t<2&&m<o[1])?(u=0,f.v=n,f.n=o[1]):m<p&&(i=t<3||o[0]>n||n>p)&&(o[4]=t,o[5]=n,f.n=p,u=0))}if(i||t>1)return s;throw d=!0,n}return function(i,c,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===c&&m(c,p),u=c,a=p;(r=u<2?e:a)||!d;){o||(u?u<3?(u>1&&(f.n=-1),m(u,a)):f.n=a:f.v=a);try{if(l=2,o){if(u||(i="next"),r=o[i]){if(!(r=r.call(o,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,u<2&&(u=0)}else 1===u&&(r=o.return)&&r.call(o),u<2&&(a=TypeError("The iterator does not provide a '"+i+"' method"),u=1);o=e}else if((r=(d=f.n<0)?a:t.call(n,f))!==s)break}catch(r){o=e,u=1,a=r}finally{l=1}}return{value:r,done:d}}}(t,i,o),!0),l}var s={};function u(){}function a(){}function l(){}r=Object.getPrototypeOf;var f=[][n]?r(r([][n]())):(d(r={},n,function(){return this}),r),m=l.prototype=u.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,d(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e}return a.prototype=l,d(m,"constructor",l),d(l,"constructor",a),a.displayName="GeneratorFunction",d(l,i,"GeneratorFunction"),d(m),d(m,i,"Generator"),d(m,n,function(){return this}),d(m,"toString",function(){return"[object Generator]"}),(c=function(){return{w:o,m:p}})()}function d(e,r,t,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}d=function(e,r,t,n){function o(r,t){d(e,r,function(e){return this._invoke(r,t,e)})}r?i?i(e,r,{value:t,enumerable:!n,configurable:!n,writable:!n}):e[r]=t:(o("next",0),o("throw",1),o("return",2))},d(e,r,t,n)}function f(e,r,t,n,i,o,s){try{var u=e[o](s),a=u.value}catch(e){return void t(e)}u.done?r(a):Promise.resolve(a).then(n,i)}function m(e){return function(){var r=this,t=arguments;return new Promise(function(n,i){var o=e.apply(r,t);function s(e){f(o,n,i,s,u,"next",e)}function u(e){f(o,n,i,s,u,"throw",e)}s(void 0)})}}function p(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,i,o,s,u=[],a=!0,l=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;a=!1}else for(;!(a=(n=o.call(t)).done)&&(u.push(n.value),u.length!==r);a=!0);}catch(e){l=!0,i=e}finally{try{if(!a&&null!=t.return&&(s=t.return(),Object(s)!==s))return}finally{if(l)throw i}}return u}}(e,r)||b(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,r){if(e){if("string"==typeof e)return h(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(e,r):void 0}}function h(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}const v=function(){var e,r=p((0,n.useState)([]),2),t=r[0],o=r[1],d=p((0,n.useState)((null===(e=window.msfAdmin)||void 0===e?void 0:e.formId)||0),2),f=d[0],b=d[1],h=p((0,n.useState)([]),2),v=h[0],_=h[1],y=p((0,n.useState)(!1),2),j=y[0],x=y[1],w=p((0,n.useState)(null),2),g=w[0],S=w[1],A=p((0,n.useState)(null),2),E=A[0],k=A[1];(0,n.useEffect)(function(){O()},[]),(0,n.useEffect)(function(){f&&D()},[f]);var O=function(){var e=m(c().m(function e(){var r,t;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,s()({path:"/wp/v2/msf_form?per_page=100"});case 1:r=e.v,o(r),r.length>0&&!f&&b(r[0].id),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error loading forms:",t);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}(),D=function(){var e=m(c().m(function e(){var r,t;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,x(!0),e.n=1,s()({path:"/msf/v1/forms/".concat(f,"/submissions")});case 1:r=e.v,_(r.submissions||[]),e.n=3;break;case 2:e.p=2,t=e.v,console.error("Error loading submissions:",t),k({type:"error",message:(0,i.__)("Failed to load submissions","multi-step-form-builder")});case 3:return e.p=3,x(!1),e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=m(c().m(function e(r){var t;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(confirm((0,i.__)("Are you sure you want to delete this submission?","multi-step-form-builder"))){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,s()({path:"/msf/v1/submissions/".concat(r),method:"DELETE"});case 2:k({type:"success",message:(0,i.__)("Submission deleted","multi-step-form-builder")}),D(),e.n=4;break;case 3:e.p=3,t=e.v,console.error("Error deleting submission:",t),k({type:"error",message:(0,i.__)("Failed to delete submission","multi-step-form-builder")});case 4:return e.a(2)}},e,null,[[1,3]])}));return function(r){return e.apply(this,arguments)}}(),C=t.map(function(e){return{label:e.title.rendered,value:e.id}});return(0,a.jsxs)("div",{className:"msf-submissions-list",children:[E&&(0,a.jsx)(u.Notice,{status:E.type,onRemove:function(){return k(null)},isDismissible:!0,children:E.message}),(0,a.jsxs)("div",{className:"msf-submissions-header",children:[(0,a.jsx)(u.SelectControl,{label:(0,i.__)("Select Form","multi-step-form-builder"),value:f,options:[{label:(0,i.__)("Select a form...","multi-step-form-builder"),value:0}].concat(l(C)),onChange:function(e){return b(parseInt(e))}}),(0,a.jsx)(u.Button,{variant:"secondary",onClick:function(){if(0!==v.length){var e=new Set;v.forEach(function(r){Object.keys(r.submission_data).forEach(function(r){return e.add(r)})});var r=["ID","Date","User ID","IP Address"].concat(l(Array.from(e))).join(",")+"\n";v.forEach(function(t){var n=[t.id,t.created_at,t.user_id||"",t.ip_address||""].concat(l(Array.from(e).map(function(e){var r=t.submission_data[e]||"";return'"'.concat(String(r).replace(/"/g,'""'),'"')})));r+=n.join(",")+"\n"});var t=new Blob([r],{type:"text/csv"}),n=window.URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="form-".concat(f,"-submissions.csv"),o.click(),window.URL.revokeObjectURL(n)}else alert((0,i.__)("No submissions to export","multi-step-form-builder"))},disabled:0===v.length,children:(0,i.__)("Export to CSV","multi-step-form-builder")})]}),j?(0,a.jsx)("div",{className:"msf-loading",children:(0,a.jsx)(u.Spinner,{})}):v.length>0?(0,a.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:(0,i.__)("ID","multi-step-form-builder")}),(0,a.jsx)("th",{children:(0,i.__)("Date","multi-step-form-builder")}),(0,a.jsx)("th",{children:(0,i.__)("User","multi-step-form-builder")}),(0,a.jsx)("th",{children:(0,i.__)("IP Address","multi-step-form-builder")}),(0,a.jsx)("th",{children:(0,i.__)("Actions","multi-step-form-builder")})]})}),(0,a.jsx)("tbody",{children:v.map(function(e){return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.id}),(0,a.jsx)("td",{children:new Date(e.created_at).toLocaleString()}),(0,a.jsx)("td",{children:e.user_id||(0,i.__)("Guest","multi-step-form-builder")}),(0,a.jsx)("td",{children:e.ip_address}),(0,a.jsxs)("td",{children:[(0,a.jsx)(u.Button,{variant:"secondary",isSmall:!0,onClick:function(){return S(e)},children:(0,i.__)("View","multi-step-form-builder")})," ",(0,a.jsx)(u.Button,{variant:"secondary",isSmall:!0,isDestructive:!0,onClick:function(){return I(e.id)},children:(0,i.__)("Delete","multi-step-form-builder")})]})]},e.id)})})]}):(0,a.jsx)("p",{children:(0,i.__)("No submissions yet.","multi-step-form-builder")}),g&&(0,a.jsx)(u.Modal,{title:(0,i.__)("Submission Details","multi-step-form-builder"),onRequestClose:function(){return S(null)},children:(0,a.jsxs)("div",{className:"msf-submission-details",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:(0,i.__)("Date:","multi-step-form-builder")})," ",new Date(g.created_at).toLocaleString()]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:(0,i.__)("User ID:","multi-step-form-builder")})," ",g.user_id||(0,i.__)("Guest","multi-step-form-builder")]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:(0,i.__)("IP Address:","multi-step-form-builder")})," ",g.ip_address]}),(0,a.jsx)("hr",{}),(0,a.jsx)("h3",{children:(0,i.__)("Form Data","multi-step-form-builder")}),(0,a.jsx)("table",{className:"widefat",children:(0,a.jsx)("tbody",{children:Object.entries(g.submission_data).map(function(e){var r=p(e,2),t=r[0],n=r[1];return(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:t}),(0,a.jsx)("td",{children:Array.isArray(n)?n.join(", "):n})]},t)})})})]})})]})}}}]);