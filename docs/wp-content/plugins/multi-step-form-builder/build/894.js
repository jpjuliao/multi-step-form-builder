/*! For license information please see 894.js.LICENSE.txt */
"use strict";(self.webpackChunkmulti_step_form_builder=self.webpackChunkmulti_step_form_builder||[]).push([[894],{894(t,e,n){n.d(e,{default:()=>x});var r=n(594),o=n(470),i=n(842),s=n.n(i),a=n(214),u=function(){var t,e,n=null===(t=window.wp)||void 0===t||null===(t=t.data)||void 0===t||null===(e=t.dispatch)||void 0===e?void 0:e.call(t,"core/editor");if(null!=n&&n.savePost)n.savePost();else{var r=document.getElementById("publish");if(r)r.click();else{var o=document.getElementById("post");o&&o.submit()}}},l=n(848);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach(function(e){p(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function p(t,e,n){return(e=function(t){var e=function(t){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof a?r:a,l=Object.create(u.prototype);return b(l,"_invoke",function(n,r,o){var i,a,u,l=0,c=o||[],f=!1,d={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(e,n){return i=e,a=0,u=t,d.n=n,s}};function m(n,r){for(a=n,u=r,e=0;!f&&l&&!o&&e<c.length;e++){var o,i=c[e],m=d.p,p=i[2];n>3?(o=p===r)&&(u=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=m&&((o=n<2&&m<i[1])?(a=0,d.v=r,d.n=i[1]):m<p&&(o=n<3||i[0]>r||r>p)&&(i[4]=n,i[5]=r,d.n=p,a=0))}if(o||n>1)return s;throw f=!0,r}return function(o,c,p){if(l>1)throw TypeError("Generator is already running");for(f&&1===c&&m(c,p),a=c,u=p;(e=a<2?t:u)||!f;){i||(a?a<3?(a>1&&(d.n=-1),m(a,u)):d.n=u:d.v=u);try{if(l=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==s)break}catch(e){i=t,a=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var s={};function a(){}function u(){}function l(){}e=Object.getPrototypeOf;var c=[][r]?e(e([][r]())):(b(e={},r,function(){return this}),e),f=l.prototype=a.prototype=Object.create(c);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,b(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,b(f,"constructor",l),b(l,"constructor",u),u.displayName="GeneratorFunction",b(l,o,"GeneratorFunction"),b(f),b(f,o,"Generator"),b(f,r,function(){return this}),b(f,"toString",function(){return"[object Generator]"}),(v=function(){return{w:i,m:d}})()}function b(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}b=function(t,e,n,r){function i(e,n){b(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},b(t,e,n,r)}function y(t,e,n,r,o,i,s){try{var a=t[i](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function s(t){y(i,r,o,s,a,"next",t)}function a(t){y(i,r,o,s,a,"throw",t)}s(void 0)})}}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,s,a=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}(t,e)||j(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,e){if(t){if("string"==typeof t)return w(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var S=(0,r.lazy)(function(){return n.e(980).then(n.bind(n,980))}),_=(0,r.lazy)(function(){return n.e(484).then(n.bind(n,484))}),O=(0,r.lazy)(function(){return n.e(280).then(n.bind(n,280))});const x=function(){var t,e=g((0,r.useState)(null),2),n=e[0],i=e[1],c=g((0,r.useState)(!0),2),d=c[0],p=c[1],b=g((0,r.useState)(!1),2),y=b[0],j=b[1],w=g((0,r.useState)(null),2),x=w[0],P=w[1],E=null===(t=window.msfAdmin)||void 0===t?void 0:t.formId,k=(0,r.useRef)(!1);(0,r.useEffect)(function(){N()},[]);var N=function(){var t=h(v().m(function t(){var e,n;return v().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,p(!0),t.n=1,s()({path:"/msf/v1/forms/".concat(E),method:"GET"});case 1:e=t.v,i(e),t.n=3;break;case 2:t.p=2,n=t.v,console.error("Error loading form:",n),P({type:"error",message:(0,o.__)("Failed to load form","multi-step-form-builder")});case 3:return t.p=3,p(!1),t.f(3);case 4:return t.a(2)}},t,null,[[0,2,3,4]])}));return function(){return t.apply(this,arguments)}}(),T=function(){var t=h(v().m(function t(){var e;return v().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,j(!0),k.current=!0,t.n=1,s()({path:"/msf/v1/forms/".concat(E),method:"POST",data:n});case 1:u(),P({type:"success",message:(0,o.__)("Form saved successfully!","multi-step-form-builder")}),setTimeout(function(){return P(null)},3e3),t.n=3;break;case 2:t.p=2,e=t.v,console.error("Error saving form:",e),P({type:"error",message:(0,o.__)("Failed to save form","multi-step-form-builder")});case 3:return t.p=3,j(!1),k.current=!1,t.f(3);case 4:return t.a(2)}},t,null,[[0,2,3,4]])}));return function(){return t.apply(this,arguments)}}(),A=function(){var t={id:"step_".concat(Date.now()),title:"",description:"",fields:[]};i(m(m({},n),{},{steps:[].concat(f(n.steps||[]),[t])}))},I=function(t,e){var r=f(n.steps),o=g(r.splice(t,1),1)[0];r.splice(e,0,o),i(m(m({},n),{},{steps:r}))},C=function(t){i(m(m({},n),{},{settings:t}))};if((0,r.useEffect)(function(){var t=function(t,e){var n,r,o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!1},a=null===(n=window.wp)||void 0===n||null===(n=n.data)||void 0===n||null===(r=n.select)||void 0===r?void 0:r.call(n,"core/editor"),u=null===(o=window.wp)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.subscribe,l=!1;if(u&&a){var c=u(function(){var n,r,o,a,u=null===(n=window.wp)||void 0===n||null===(n=n.data)||void 0===n||null===(r=n.select)||void 0===r?void 0:r.call(n,"core/editor"),c=null==u||null===(o=u.isSavingPost)||void 0===o?void 0:o.call(u),f=null==u||null===(a=u.isAutosavingPost)||void 0===a?void 0:a.call(u);if(c&&!f){if(!l&&(l=!0,!i())){var d=e();s()({path:"/msf/v1/forms/".concat(t),method:"POST",data:d}).catch(function(){})}}else l=!1});return"function"==typeof c?c:function(){}}var f=function(){var n=e();s()({path:"/msf/v1/forms/".concat(t),method:"POST",data:n}).catch(function(){})},d=document.getElementById("publish"),m=document.getElementById("save-post");return d&&d.addEventListener("click",f,{once:!1}),m&&m.addEventListener("click",f,{once:!1}),function(){d&&d.removeEventListener("click",f),m&&m.removeEventListener("click",f)}}(E,function(){return n},function(){return k.current});return function(){"function"==typeof t&&t()}},[E,n]),d)return(0,l.jsxs)("div",{className:"msf-loading",children:[(0,l.jsx)(a.Spinner,{}),(0,l.jsx)("p",{children:(0,o.__)("Loading form...","multi-step-form-builder")})]});var B=[{name:"steps",title:(0,o.__)("Steps","multi-step-form-builder"),className:"msf-tab-steps"},{name:"header",title:(0,o.__)("Header","multi-step-form-builder"),className:"msf-tab-header"},{name:"settings",title:(0,o.__)("Settings","multi-step-form-builder"),className:"msf-tab-settings"}];return(0,l.jsxs)("div",{className:"msf-form-builder",children:[x&&(0,l.jsx)(a.Notice,{status:x.type,onRemove:function(){return P(null)},isDismissible:!0,children:x.message}),(0,l.jsx)("div",{className:"msf-builder-header",children:(0,l.jsx)(a.Button,{variant:"primary",onClick:T,isBusy:y,disabled:y,children:y?(0,o.__)("Saving...","multi-step-form-builder"):(0,o.__)("Save Form","multi-step-form-builder")})}),(0,l.jsx)(a.TabPanel,{className:"msf-tabs",activeClass:"is-active",tabs:B,children:function(t){return(0,l.jsx)(r.Suspense,{fallback:(0,l.jsx)("div",{className:"msf-loading-tab",children:(0,l.jsx)(a.Spinner,{})}),children:"header"===t.name?(0,l.jsx)("div",{className:"msf-header-panel",children:(0,l.jsx)(O,{formConfig:n,updateFormConfig:i})}):"steps"===t.name?(0,l.jsxs)("div",{className:"msf-steps-panel",children:[(null===(e=n.steps)||void 0===e?void 0:e.length)>0?n.steps.map(function(t,e){return(0,l.jsxs)("div",{className:"msf-step-wrapper",children:[(0,l.jsxs)("div",{className:"msf-step-controls",children:[(0,l.jsxs)("span",{className:"msf-step-number",children:[(0,o.__)("Step","multi-step-form-builder")," ",e+1]}),(0,l.jsxs)("div",{className:"msf-step-move-buttons",children:[e>0&&(0,l.jsx)(a.Button,{icon:"arrow-up",onClick:function(){return I(e,e-1)},label:(0,o.__)("Move Up","multi-step-form-builder"),isSmall:!0}),e<n.steps.length-1&&(0,l.jsx)(a.Button,{icon:"arrow-down",onClick:function(){return I(e,e+1)},label:(0,o.__)("Move Down","multi-step-form-builder"),isSmall:!0})]})]}),(0,l.jsx)(S,{step:t,stepIndex:e,onUpdate:function(t){return function(t,e){var r=f(n.steps);r[t]=e,i(m(m({},n),{},{steps:r}))}(e,t)},onDelete:function(){return t=e,r=n.steps.filter(function(e,n){return n!==t}),void i(m(m({},n),{},{steps:r}));var t,r}})]},t.id||e)}):(0,l.jsx)("div",{className:"msf-empty-state",children:(0,l.jsx)("p",{children:(0,o.__)("No steps yet. Add your first step to get started.","multi-step-form-builder")})}),(0,l.jsx)(a.Button,{variant:"secondary",onClick:A,className:"msf-add-step-btn",children:(0,o.__)("Add Step","multi-step-form-builder")})]}):"settings"===t.name?(0,l.jsx)(_,{settings:n.settings||{},onUpdate:C,formId:E}):void 0});var e}})]})}}}]);